<!DOCTYPE html>
<html lang="en" style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
  <title></title>
  <!-- 核心引擎（必须引用） -->
  <link href="http://tkbim-sdk.tfhulian.com:7282/v1.0/Widgets/widgets.css" rel="stylesheet" />
  <script src="http://tkbim-sdk.tfhulian.com:7282/v1.0/TkEngine.js"></script>
</head>

<body style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden">
  <!-- 引擎渲染容器 -->
  <div id="tkEngineContainer" style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden"></div>
  <div style="
        background-color: rgba(39, 39, 39, 0.7);
        position: absolute;
        z-index: 10;
        top: 10px;
        left: 5px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: space-around;
        color: white;
        border-radius: 5px;
        padding: 5px;
      ">
    <button type="button" onclick="startBoxChoose(true)">开启热泪图</button>
    <button type="button" onclick="startBoxChoose(false)" style="margin-top: 10px">
      关闭热泪图
    </button>
  </div>
</body>
<!-- 引擎操作器（必须引用） -->
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/three.min.js"></script>
<!-- 提供对外bim功能接口（必须引用）-->
<script src="http://60.30.241.14:2628/bimjs/tkengines/tkbim/v0.9.3/tkbim.js"></script>
<script src="http://60.30.241.14:2628/bimjs/tkengines/tkbim/v0.9.3/tkbimsdk.js"></script>
<!-- jquery 引擎操作工具（必须引用）-->
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/jquery-3.4.1.min.js"></script>
<!-- 引擎热力图插件，不使用热力图功能可不引用此js -->
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/heatmap/heatmap.min.js"></script>
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/heatmap/tkEngineheatmap.js"></script>
<script>
  // 初始化引擎
  var bimViewer = new TKBimSdk.BIMViewer();

  //加载场景
  bimViewer.loadScene();
  //模型参数配置
  var model = {
    baseDomain: "https://tkbim-dataserver.tfhulian.com:2627", // BIM模型数据接口服务域名地址
    projectId: "bd425ebdc86b457992a99471fd67ddae", //项目id
    viewId: "0e60c8f535b245de824f6dacf07ae5b9", //模型viewId
    modelCenter: {
      longitude: 117.24249519270747,
      latitude: 39.080722698745542,
      altitude: 3,
    }, //模型中心点坐标：{经度,纬度,高程}
    viewRatio: 50, //模型可视距离系数
  };
  // 添加模型（可在加载场景之前添加模型，此时添加模型的callback回调不起作用）
  bimViewer.addModel(model, (viewId) => {
    //添加模型的回调方法
    bimViewer.setModelCollect([viewId], true); //设置模型组同时移动到模型位置
  });
  //开启热力图
  function startBoxChoose(type) {
    let param = {
      data: [
        { x: 117.242205268425, y: 39.08070989780412, value: 0.01 },
        { x: 117.2421912054896, y: 39.080803028297886, value: 0.01 },
        { x: 117.24278889326806, y: 39.08078948613686, value: 0.01 },
        { x: 117.24272151010828, y: 39.08075499800578, value: 0.01 },
        { x: 117.2423694014836, y: 39.08079316407406, value: 0.99 },
        { x: 117.24259647143806, y: 39.08079409682197, value: 0.99 },
      ],

      bounds: {
        west: 117.242 - 0.09,
        east: 117.242 + 0.09,
        south: 39.08 - 0.09,
        north: 39.08 + 0.09,
      },
      style: {
        radius: 1,
        opacity: 1,
        maxOpacity: 1,
        minOpacity: 1,
        blur: 0,
        gradient: {
          ".01": "blue",
          ".5": "red",
          ".99": "red",
        },
      },
    };
    if (type == true) {
      // 开启热力图

      bimViewer.visibleHeadMap(true, param);
    } else {
      // 关闭热力图

      bimViewer.visibleHeadMap(false, param);
    }
  }
</script>

</html>
