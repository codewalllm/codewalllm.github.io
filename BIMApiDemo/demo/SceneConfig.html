<!DOCTYPE html>
<html lang="en" style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <title>场景参数配置</title>
    <!-- 核心引擎（必须引用） -->
    <link href="http://60.30.241.14:2650/bimjs/tkengines/tkgis/v0.9.4/Widgets/widgets.css" rel="stylesheet" />
    <script src="http://60.30.241.14:2650/bimjs/tkengines/tkgis/v0.9.4/TkEngine.js"></script>
    <!-- 引擎插件（必须引用） -->
    <script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/three.min.js"></script>
    <!-- 提供对外bim功能接口（必须引用）-->
    <script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/tkbim.js"></script>
    <script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/tkbimsdk.js"></script>
</head>

<body style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;">
    <!-- 引擎渲染容器 -->
    <div id="tkEngineContainer" style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;"></div>
    <div
        style="background-color: rgba(39, 39, 39, 0.7);position: absolute;z-index: 10;top: 10px;left: 5px;display: flex;flex-direction: column;align-items: center;justify-content: space-around;color: white;border-radius: 5px;padding: 5px;">
        <button type="button"
            onclick="TKBimSdk.Control.setVisibleCube(sceneOptions.controls.visibleCube=!sceneOptions.controls.visibleCube)">
            操作器显隐
        </button>
        <button type="button"
            onclick="TKBimSdk.Control.setVisibleFPS(sceneOptions.controls.visibleFPS=!sceneOptions.controls.visibleFPS)"
            style="margin-top: 10px;">帧率显隐</button>
    </div>
</body>

<script>
    //场景参数配置
    let sceneOptions = {
        isBimViewMode: true,//是否BIM模式加载(false:GIS模式，true:BIM模式，默认true),非必填。
        isModelsCenter: true,//设置模型场景下的旋转中心(true：以模型为中心,false：以GIS场景为中心，默认true),非必填。
        isTransparentOfDis: 0,//定位构件后是否优化渲染效率设置（相机与选中构件透明化大距离，默认50米，设置为0则相机与构件中间始终透明,非必填。
        controls: {
            visibleCube: true,//是否显示操作器,默认true,非必填
            visibleFPS: true,//是否显示帧率,默认true,非必填
        }
    };
    // 场景回调
    let initedCallbacks = {
        //模型数据初始化完毕
        sceneInitedCb: () => { },
        //鼠标左键点击
        onMouseLeftClickCb: (data) => { },
        //鼠标右键点击
        onMouseRightClick: (data) => { },
        //鼠标左键拖拽
        onMouseLeftDraggingCb: () => { },
        //鼠标滚轮滚动事件
        onMouseWheelCb: () => { },
        // 加载进度 - 剩余加载数
        onTilesetLoadingCb: (num) => { },
        //框选回调
        onBoxChooseCb: (viewIds) => { },
    }
    //设置场景
    TKBimSdk.Scene.loadScene(sessionStorage.getItem("token"), sceneOptions, initedCallbacks);
    //模型参数配置
    var model = {
        baseDomain: "https://tkbim-dataserver.tfhulian.com:2627", // BIM模型数据接口服务域名地址
        projectId: "bd425ebdc86b457992a99471fd67ddae",//项目id
        viewId: "0e60c8f535b245de824f6dacf07ae5b9",//模型viewId
        modelCenter: { longitude: 117.24249519270747, latitude: 39.080722698745542, altitude: 3 }, //模型中心点坐标：{经度,纬度,高程}
        viewRatio: 50, //模型可视距离系数
    };
    // 添加模型（可在加载场景之前添加模型，此时添加模型的callback回调不起作用）
    TKBimSdk.TK3DTileset.add3DTiles_Bim(model, (viewId) => {
        //添加模型的回调方法
        TKBimSdk.TK3DTileset.setCollect([viewId], true); //设置模型组同时移动到模型位置
    });
</script>

</html>