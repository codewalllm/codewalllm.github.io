<!DOCTYPE html>
<html lang="en" style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;">

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
	<title>左键选中/取消选中构件</title>
	<!-- 核心引擎（必须引用） -->
	<link href="http://tkbim-sdk.tfhulian.com:7282/v1.0/Widgets/widgets.css" rel="stylesheet" />
	<script src="http://tkbim-sdk.tfhulian.com:7282/v1.0/TkEngine.js"></script>
</head>

<body style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;">
	<!-- 引擎渲染容器 -->
	<div id="tkEngineContainer" style="width: 100%;height: 100%;margin: 0;padding: 0;overflow: hidden;"></div>
</body>
<!-- 引擎操作器（必须引用） -->
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/three.min.js"></script>
<!-- 提供对外bim功能接口（必须引用）-->
<script src="http://60.30.241.14:2628/bimjs/tkengines/tkbim/v0.9.3/tkbim.js"></script>
<script src="http://60.30.241.14:2628/bimjs/tkengines/tkbim/v0.9.3/tkbimsdk.js"></script>
<!-- jquery 引擎操作工具（必须引用）-->
<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/jquery-3.4.1.min.js"></script>

<script>
	// 初始化引擎
	var bimViewer = new TKBimSdk.BIMViewer();
	// 选中的构件
	let changeEleId = '';
	//设置场景 - 参数全取默认值
	bimViewer.setScene(null, {
		//左键点击
		onMouseLeftClickCb: (data) => {
			// 重置构件颜色
			bimViewer.resetElementsColorAll();
			if (data.pos && changeEleId != data.eleID) {
				changeEleId = data.eleID;
				// 选中构件设置为焦点
				bimViewer.setViewCenterByElement(data.viewId, data.eleID);
				// 设置构件的颜色
				bimViewer.setElementColor(data.viewId, [data.eleID], [255, 0, 0]);
			} else {
				changeEleId = "";
				// 取消构件的选中
				bimViewer.cancelViewCenterByElement();
			}
		},
	});
	//加载场景
	bimViewer.loadScene();
	//模型参数配置
	var model = {
		baseDomain: "https://tkbim-dataserver.tfhulian.com:2627", // BIM模型数据接口服务域名地址
		projectId: "bd425ebdc86b457992a99471fd67ddae",//项目id
		viewId: "0e60c8f535b245de824f6dacf07ae5b9",//模型viewId
		modelCenter: { longitude: 117.24249519270747, latitude: 39.080722698745542, altitude: 3 }, //模型中心点坐标：{经度,纬度,高程}
		viewRatio: 50, //模型可视距离系数
	};
	// 添加模型（可在加载场景之前添加模型，此时添加模型的callback回调不起作用）
	bimViewer.addModel(model, (viewId) => {
		//添加模型的回调方法
		bimViewer.setModelCollect([viewId], true);//设置模型组同时移动到模型位置
	});
</script>

</html>
