<!DOCTYPE html>
<html lang="en" style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden">

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
	<title>圆柱模型</title>
	<!-- 核心引擎（必须引用） -->
	<link href="http://60.30.241.14:2650/bimjs/tkengines/tkgis/v0.9.4/Widgets/widgets.css" rel="stylesheet" />
	<script src="http://60.30.241.14:2650/bimjs/tkengines/tkgis/v0.9.4/TkEngine.js"></script>
	<!-- 引擎插件（必须引用） -->
	<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/three.min.js"></script>
	<!-- 提供对外bim功能接口（必须引用）-->
	<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/tkbim.js"></script>
	<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/tkbimsdk.js"></script>
	<script src="http://60.30.241.14:2650/bimjs/tkengines/tkbim/v0.9.4/plugin/jquery-3.4.1.min.js"></script>
</head>

<body style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden">
	<!-- 引擎渲染容器 -->
	<div id="tkEngineContainer" style="width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden"></div>
	<div
		style="background-color: rgba(39, 39, 39, 0.7);position: absolute;z-index: 10;top: 10px;left: 5px;display: flex;flex-direction: column;align-items: center;justify-content: space-around;color: white;border-radius: 5px;padding: 5px;">
		<button type="button" onclick="AddCylinders()">
			添加模型
		</button>
	</div>
</body>
<script>
	//加载场景
	TKBimSdk.Scene.loadScene(sessionStorage.getItem("token"));
	//模型参数配置
	var model = {
		baseDomain: "https://tkbim-dataserver.tfhulian.com:2627", // BIM模型数据接口服务域名地址
		projectId: "bd425ebdc86b457992a99471fd67ddae", //项目id
		viewId: "0e60c8f535b245de824f6dacf07ae5b9", //模型viewId
		modelCenter: {
			longitude: 117.24249519270747,
			latitude: 39.080722698745542,
			altitude: 3,
		}, //模型中心点坐标：{经度,纬度,高程}
		viewRatio: 50, //模型可视距离系数
	};
	// 添加模型（可在加载场景之前添加模型，此时添加模型的callback回调不起作用）
	TKBimSdk.TK3DTileset.add3DTiles_Bim(model, (viewId) => {
		//添加模型的回调方法
		TKBimSdk.TK3DTileset.setCollect([viewId], true); //设置模型组同时移动到模型位置
	});

	// 添加编辑器编辑的模型
	function AddCylinders() {
		// 移除模型
		TKBimSdk.GraphicsModel.remove("CylinderModel")
		// 添加模型
		TKBimSdk.GraphicsModel.addCylinder({
			id: "CylinderModel1", //模型id    
			coordinate: { x: -2269410.015846342, y: 4407767.260073476, z: 3999288.546686958 }, // 坐标
			topRadius: 1, //圆柱顶部半径,非必要,默认1,单位：米
			bottomRadius: 1,//圆柱底部半径,非必要,默认1,单位：米
			height: 1, //圆柱高度,非必要,默认1,单位：米
			rotate: { heading: 0, pitch: 0, roll: 0 }, //模型摆放角度,非必要,默认0
			color: [255, 0, 0, 0.7], //模型颜色,非必要,默认[255,0,0,1]
			labelAlwaysShow: false, //标签是否是保持显示（不被三维中的物体遮挡）,默认false，非必要
			textLabel: { //文字标签,非必要
				text: "圆柱", //文字内容
				pixelOffset: { x: 0, y: -10 }, //标签像素偏移量,非必要,默认0
				backgroundColor: [255, 0, 0, 1], //标签背景颜色,默认无背景颜色,非必要,非必要
			},
		});

		// 添加模型
		TKBimSdk.GraphicsModel.addCylinder({
			id: "CylinderModel2", //模型id    
			coordinate: { x: -2269421.1858362705, y: 4407761.67417692, z: 3999288.365811944 }, // 坐标
			topRadius: 0, //圆柱顶部半径,非必要,默认1,单位：米
			bottomRadius: 1,//圆柱底部半径,非必要,默认1,单位：米
			height: 1, //圆柱高度,非必要,默认1,单位：米
			rotate: { heading: 0, pitch: 0, roll: 0 }, //模型摆放角度,非必要,默认0
			color: [255, 255, 0, 0.7], //模型颜色,非必要,默认[255,0,0,1]
			labelAlwaysShow: false, //标签是否是保持显示（不被三维中的物体遮挡）,默认false，非必要
			imgLabel: {//图片标签,非必要
				img: "./img/6828173.png", //图片路径或base64格式图片
				width: 48, //图片宽,默认30,非必要
				height: 48, //图片高,默认30,非必要
				pixelOffset: { x: 0, y: -10 } //标签像素偏移量,非必要,默认0
			}
		})
	}
</script>

</html>
