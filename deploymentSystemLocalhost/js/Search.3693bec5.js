import{u as e}from"./vuex.1b7a4305.js";import{d as l,e as a,j as t,o,M as d,O as i,u as n,ah as r,a as s,S as u,c as m,U as c,F as p,a7 as y,T as g,P as b,ap as f,R as v,I as k,Z as h,i as V,n as w,a8 as F}from"./@vue.d99a4689.js";import{u as _,b as D}from"./vue-router.25eb8d08.js";import{a as C}from"./axios.b084b850.js";import{s as U}from"./index.27c85ee3.js";import{E as q}from"./element-plus.68ef0b35.js";import{_ as x}from"./_plugin-vue_export-helper.1b428a4d.js";const $=C.create({baseURL:"http://localhost:3000",timeout:1e4});function j(){return $({url:"/node/list",method:"get"})}$.interceptors.request.use((e=>(U.commit("SETLOADING",{requestTotal:U.getters.loading.requestTotal+1}),e)),(e=>Promise.reject(e))),$.interceptors.response.use((e=>{U.commit("SETLOADING",{requestTotal:U.getters.loading.requestTotal-1});const l=e.data;return l.code?(q.error(l.msg),Promise.reject(l)):Promise.resolve(l)}),(e=>(U.commit("SETLOADING",{requestTotal:U.getters.loading.requestTotal-1}),q.error(e.message),Promise.reject(e))));const S="codeinfo";function I(e){return $({url:`/${S}/list`,method:"post",data:e})}function T(e){return $({url:`/${S}/add`,method:"post",data:e})}function L(e){return $({url:`/${S}/details`,method:"get",params:e})}function z(e){return $({url:`/${S}/update`,method:"post",data:e})}function A(e){return $({url:`/${S}/delete`,method:"post",data:e})}const O="projectdeploy";function B(e){return $({url:`/${O}/list`,method:"post",data:e})}function P(e){return $({url:`/${O}/add`,method:"post",data:e})}function E(e){return $({url:`/${O}/details`,method:"get",params:e})}function N(e){return $({url:`/${O}/update`,method:"post",data:e})}function M(e){return $({url:`/${O}/delete`,method:"post",data:e})}function G(e){return $({url:`/${O}/codeBranchList`,method:"get",params:e})}function R(e){return $({url:`/${O}/codeBranchswitch`,method:"post",data:e})}function H(e){return $({url:`/${O}/deploy`,method:"post",data:e})}const K={class:"dialog-footer"},Y=l({__name:"DialogForm",props:{dialogForm:{type:Object,default:{visible:!1,title:"弹框",width:"40%",btnInfo:{key:"",label:"弹框标题"},formList:[{required:!0,type:"select",label:"存放方式",key:"svnorgit",options:[{label:"svn",value:"svn"},{label:"git",value:"git"}]},{required:!0,type:"input",label:"代码地址",key:"codeUrl"},{required:!0,type:"nodeVersion",label:"node版本",key:"nodeVersion"},{type:"textarea",label:"备注",key:"notes"}],formData:{}}}},emits:["submitForm"],setup(l,{emit:g}){const b=e(),{selectConfig:f}=b.getters,v=l,k=g,h=a(),V=t((()=>["details"].includes(v.dialogForm.btnInfo.key))),w=e=>{v.dialogForm.formList.forEach((l=>{"codeVersion"==l.type&&(Object.assign(l,{hidden:!0}),v.dialogForm.formData.codeVersion="",setTimeout((()=>{Object.assign(l,{hidden:!e||"trunk"==e})}),16))}))};return(e,a)=>{var t,g,F;const _=r("el-option"),D=r("el-select"),C=r("el-input"),U=r("el-form-item"),q=r("el-form"),x=r("el-button"),$=r("el-dialog");return o(),d($,{modelValue:l.dialogForm.visible,"onUpdate:modelValue":a[6]||(a[6]=e=>l.dialogForm.visible=e),title:(null==(g=null==(t=l.dialogForm)?void 0:t.btnInfo)?void 0:g.label)||"标题",width:(null==(F=l.dialogForm)?void 0:F.width)||"40%",draggable:"","close-on-click-modal":!1,"destroy-on-close":"",onClosed:a[7]||(a[7]=e=>{var l;(l=n(h))&&l.resetFields()})},{footer:i((()=>{var e,t,r,y,g,f,w,F,_,D,C,U;return[s("span",K,[n(V)?(o(),d(x,{key:0,onClick:a[3]||(a[3]=e=>l.dialogForm.visible=!1)},{default:i((()=>[u(" 关 闭 ")])),_:1})):(o(),m(p,{key:1},[c(x,{disabled:null==(r=null==(t=null==(e=n(b))?void 0:e.getters)?void 0:t.loading)?void 0:r.request,loading:(null==(f=null==(g=null==(y=n(b))?void 0:y.getters)?void 0:g.loading)?void 0:f.request)||l.dialogForm.formData.loading,onClick:a[4]||(a[4]=e=>l.dialogForm.visible=!1)},{default:i((()=>[u(" 取 消 ")])),_:1},8,["disabled","loading"]),c(x,{disabled:null==(_=null==(F=null==(w=n(b))?void 0:w.getters)?void 0:F.loading)?void 0:_.request,loading:(null==(U=null==(C=null==(D=n(b))?void 0:D.getters)?void 0:C.loading)?void 0:U.request)||l.dialogForm.formData.loading,type:"primary",onClick:a[5]||(a[5]=e=>(async e=>{e&&await e.validate(((e,l)=>{e&&k("submitForm",v.dialogForm)}))})(n(h)))},{default:i((()=>[u(" 保 存 ")])),_:1},8,["disabled","loading"])],64))])]})),default:i((()=>[c(q,{ref_key:"elfrom",ref:h,model:l.dialogForm.formData,"label-width":"auto",disabled:n(V)||l.dialogForm.formData.loading},{default:i((()=>[(o(!0),m(p,null,y(v.dialogForm.formList.filter((e=>!e.hidden)),(e=>(o(),d(U,{label:e.label,key:e.key,prop:e.key,rules:[{required:!n(V)&&(e.required||!1),message:"不能为空",trigger:["blur","change"]}]},{default:i((()=>{var t,r,s,u,c,g;return["select"==e.type?(o(),d(D,{key:0,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择"},{default:i((()=>[(o(!0),m(p,null,y(e.options,(e=>(o(),d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):["envConfig","deployMethod"].includes(e.type)?(o(),d(D,{key:1,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择"},{default:i((()=>[(o(!0),m(p,null,y(n(f)[e.type].list,(e=>(o(),d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"codeinfo"==e.type?(o(),d(D,{key:2,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,loading:null==(r=null==(t=n(f))?void 0:t.codeinfo)?void 0:r.loading,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择",onVisibleChange:a[0]||(a[0]=e=>n(b).dispatch("SetSelectConfig",{key:"codeinfo",interface:n(I),params:{},refresh:e}))},{default:i((()=>{var e,l;return[(o(!0),m(p,null,y((null==(l=null==(e=n(f))?void 0:e.codeinfo)?void 0:l.list)||[],(e=>(o(),d(_,{key:e.id,label:`${e.codeName} (${e.svnorgit}) (${e.codeUrl.split("/").at(-1)})`,value:e.id},null,8,["label","value"])))),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","loading","disabled"])):"codeBranch"==e.type?(o(),d(D,{key:3,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择",onChange:w},{default:i((()=>[(o(!0),m(p,null,y(e.options,(e=>(o(),d(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):"codeVersion"==e.type?(o(),d(D,{key:4,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,loading:null==(u=null==(s=n(f))?void 0:s.codeVersioninfo)?void 0:u.loading,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择",onVisibleChange:a[1]||(a[1]=e=>{var a,t,o,d;return n(b).dispatch("SetSelectConfig",{key:"codeVersioninfo",interface:n(G),params:{id:null==(t=null==(a=l.dialogForm)?void 0:a.formData)?void 0:t.id,branch:null==(d=null==(o=l.dialogForm)?void 0:o.formData)?void 0:d.codeBranch},refresh:e})})},{default:i((()=>{var e,l;return[(o(!0),m(p,null,y((null==(l=null==(e=n(f))?void 0:e.codeVersioninfo)?void 0:l.list)||[],(e=>(o(),d(_,{key:e,label:e,value:e},null,8,["label","value"])))),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","loading","disabled"])):"nodeVersion"==e.type?(o(),d(D,{key:5,style:{width:"100%"},modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,loading:null==(g=null==(c=n(f))?void 0:c.nodeInfo)?void 0:g.loading,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择",onVisibleChange:a[2]||(a[2]=e=>n(b).dispatch("SetSelectConfig",{key:"nodeInfo",interface:n(j),params:{}}))},{default:i((()=>{var e,l;return[(o(!0),m(p,null,y((null==(l=null==(e=n(f))?void 0:e.nodeInfo)?void 0:l.list)||[],(e=>(o(),d(_,{key:e,label:e,value:e},null,8,["label","value"])))),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","loading","disabled"])):"textarea"==e.type?(o(),d(C,{key:6,type:"textarea",modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,maxlength:(null==e?void 0:e.maxlength)||"",disabled:e.disabled,"show-word-limit":"",clearable:"",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue","maxlength","disabled"])):(o(),d(C,{key:7,modelValue:l.dialogForm.formData[e.key],"onUpdate:modelValue":a=>l.dialogForm.formData[e.key]=a,maxlength:(null==e?void 0:e.maxlength)||"",disabled:e.disabled,"show-word-limit":"",clearable:"",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue","maxlength","disabled"]))]})),_:2},1032,["label","prop","rules"])))),128))])),_:1},8,["model","disabled"])])),_:1},8,["modelValue","title","width"])}}}),Z={class:"flex margin-t-15"},J={class:"flex-1"},Q=l({__name:"Pagination",props:{btnInfos:{type:Array,default:[]},pagination:{type:Object,default:{ifPage:!1,loading:!1,page:1,size:10,total:0}}},emits:["clickBtn","page","size"],setup(l,{emit:a}){_(),D();const t=e(),b=a,f=l,v=e=>{b("page",e)},k=e=>{b("size",e)};return(e,a)=>{var h,V,w;const F=r("el-button"),_=r("el-pagination");return o(),m("div",Z,[s("div",J,[(o(!0),m(p,null,y(l.btnInfos,((e,a)=>{var r,s,m;return o(),d(F,{disabled:(null==(m=null==(s=null==(r=n(t))?void 0:r.getters)?void 0:s.loading)?void 0:m.request)||l.pagination.loading,key:a,type:e.type,onClick:l=>b("clickBtn",e)},{default:i((()=>[u(g(e.label),1)])),_:2},1032,["disabled","type","onClick"])})),128))]),c(_,{"current-page":f.pagination.page,"onUpdate:currentPage":a[0]||(a[0]=e=>f.pagination.page=e),"page-size":f.pagination.size,"onUpdate:pageSize":a[1]||(a[1]=e=>f.pagination.size=e),disabled:(null==(w=null==(V=null==(h=n(t))?void 0:h.getters)?void 0:V.loading)?void 0:w.request)||l.pagination.loading,"page-sizes":[1,10,20,50,100],layout:"prev, pager, next, jumper, sizes, total",total:f.pagination.total,onCurrentChange:v,onSizeChange:k},null,8,["current-page","page-size","disabled","total"])])}}});function W(e=new Date,l="{y}-{m}-{d} {h}:{i}:{s}"){let a,t;switch(a="string"==typeof e?new Date(e):e,l){case"date":t="{y}-{m}-{d}";break;case"dateTime":t="{y}-{m}-{d} {h}:{i}:{s}";break;default:t=l}const o={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()};return t.replace(/{(y|m|d|h|i|s|a)+}/g,((e,l)=>{let a=o[l];return"a"===l?["日","一","二","三","四","五","六"][a]:(e.length>0&&a<10&&(a="0"+a),a||0)}))}const X={class:"flex flex-column h-100p overflow-auto"},ee=["onClick"],le={key:0},ae={key:1},te={key:2},oe={key:3},de={key:4},ie={key:5},ne={key:6},re={key:7},se=s("div",{class:"flex-1-1"},null,-1),ue=l({__name:"Table",props:{btnInfos:{type:Array,default:[]},tableList:{type:Array,default:[{type:"name",label:"姓名",key:"name"},{type:"select",label:"状态",key:"status",options:{1:"获取代码",2:"获取依赖",3:"打包中"}},{type:"date",label:"日期",key:"date"},{type:"datetime",label:"时间",key:"datetime"}]},tableData:{type:Object,default:{loading:!1,data:[{name:"回复哎对佛化身fish的粉丝u护发素爱妃哈桑回复i阿瑟东合法随风哈随",status:"1",date:"2023-05-26",datetime:new Date}]}}},emits:["handleSelectionChange"],setup(e,{emit:l}){const t=a(),h=l,V=e,w=e=>{let l;switch(e.type){case"datetime":l=180;break;case"date":case"tel":l=120;break;default:l="auto"}return e.width||l};return(l,a)=>{const F=r("el-table-column"),_=r("el-button"),D=r("el-table"),C=f("loading");return o(),m("div",X,[b((o(),d(D,{ref_key:"tableRef",ref:t,border:"",stripe:"","highlight-current-row":"",data:V.tableData.data,"header-cell-style":{background:"#eef1f6"},"empty-text":"暂无数据",onSelectionChange:a[0]||(a[0]=e=>{V.tableData.selectData=e})},{default:i((()=>{var a;return[(null==(a=e.btnInfos)?void 0:a.length)>0?(o(),d(F,{key:0,align:"center",type:"selection",width:"50"})):v("",!0),c(F,{align:"center",type:"index",label:"序号",width:"60"}),(o(!0),m(p,null,y(V.tableList,(e=>(o(),d(F,{align:"center","show-overflow-tooltip":"",key:e.key,label:e.label,"min-width":w(e)},{default:i((a=>{var t,r,c,b,f,v,V,w,F;return[s("div",{class:k({"cursor-pointer":e.click}),onClick:l=>e.click&&h("clickTable",e,a.row)},[["date"].includes(e.type)&&a.row[e.key]?(o(),m("div",le,g(n(W)(a.row[e.key],"{y}-{m}-{d}")),1)):["datetime"].includes(e.type)&&a.row[e.key]?(o(),m("div",ae,g(n(W)(a.row[e.key])),1)):["select"].includes(e.type)&&a.row[e.key]?(o(),m("div",te,g((null==(t=null==e?void 0:e.options)?void 0:t[a.row[e.key]])||"--"),1)):["envConfig"].includes(e.type)&&a.row[e.key]?(o(),m("div",oe,g((null==(c=null==(r=l.$store.getters.selectConfig.envConfig.list)?void 0:r.filter((l=>l.value==a.row[e.key]))[0])?void 0:c.label)||"--"),1)):["codeUrl"].includes(e.type)&&a.row[e.key]?(o(),m("div",de,g(null==(v=null==(f=null==(b=a.row)?void 0:b[e.key])?void 0:f.split("/"))?void 0:v.at(-1)),1)):["codeVersion"].includes(e.type)&&(a.row[e.key]||a.row.codeBranch)?(o(),m("div",ie,g((null==(V=a.row)?void 0:V[e.key])||a.row.codeBranch),1)):["button"].includes(e.type)&&(null==(w=null==e?void 0:e.btns)?void 0:w.length)>0?(o(),m("div",ne,[(o(!0),m(p,null,y(e.btns,(e=>{var t,n,r;return o(),d(_,{type:"text",key:e.key,disabled:null==(r=null==(n=null==(t=l.$store)?void 0:t.getters)?void 0:n.loading)?void 0:r.request,onClick:l=>h("clickBtn",e,a.row)},{default:i((()=>[u(g(e.label),1)])),_:2},1032,["disabled","onClick"])})),128))])):(o(),m("div",re,g((null==(F=a.row)?void 0:F[e.key])||"--"),1))],10,ee)]})),_:2},1032,["label","min-width"])))),128))]})),_:1},8,["data"])),[[C,V.tableData.loading]]),se])}}}),me=x(l({__name:"Search",props:{formList:{type:Array,default:[{type:"input",label:"输入框",key:"input"},{type:"select",label:"选择",key:"select",options:[{label:"选择1",value:"1"},{label:"选择2",value:"2"}]}]},tableData:{type:Object,default:{loading:!1}}},emits:["query"],setup(l,{emit:t}){const s=_(),g=D(),b=e(),{selectConfig:f}=b.getters,v=a(),k=t,C=l,U=h({});V((()=>{w((()=>{C.formList.forEach((e=>{U[`${e.key}`]=e.value||"","codeinfo"==e.type&&b.dispatch("SetSelectConfig",{key:"codeinfo",interface:I,params:{}})})),setTimeout((()=>{for(let e in s.query)Array.isArray(U[e])?Array.isArray(s.query[e])?U[e].push(...s.query[e]):U[e].push(s.query[e]):U[e]=s.query[e];q()}),16)}))}));const q=()=>{let e=Object.assign({},U);b.getters.tabs.forEach((l=>{l.path==s.path&&(l.query=e)})),g.replace({path:s.path,query:e,params:(null==s?void 0:s.params)||{}}),k("query",U)};return(e,l)=>{var a,t,s;const g=r("el-option"),k=r("el-select"),h=r("el-input"),V=r("el-form-item"),w=r("el-button"),_=r("el-form");return o(),d(_,{ref_key:"elfrom",ref:v,class:"elfrom",inline:"",model:U,disabled:null==(s=null==(t=null==(a=n(b))?void 0:a.getters)?void 0:t.loading)?void 0:s.request,onKeyup:F(q,["enter"])},{default:i((()=>[(o(!0),m(p,null,y(C.formList,(e=>(o(),d(V,{label:e.label,key:e.key,prop:e.key,rules:[{required:!1,message:"不能为空",trigger:["blur","change"]}]},{default:i((()=>{var l,a;return["select"==e.type?(o(),d(k,{key:0,style:{width:"200px"},modelValue:U[e.key],"onUpdate:modelValue":l=>U[e.key]=l,filterable:"",clearable:"",placeholder:"请选择"},{default:i((()=>[(o(!0),m(p,null,y(e.options,(e=>(o(),d(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):"codeinfo"==e.type?(o(),d(k,{key:1,style:{width:"200px"},modelValue:U[e.key],"onUpdate:modelValue":l=>U[e.key]=l,loading:null==(a=null==(l=n(f))?void 0:l.codeinfo)?void 0:a.loading,filterable:"",clearable:"",placeholder:"请选择"},{default:i((()=>{var e,l;return[(o(!0),m(p,null,y((null==(l=null==(e=n(f))?void 0:e.codeinfo)?void 0:l.list)||[],(e=>(o(),d(g,{key:e.id,label:`${e.codeName} (${e.svnorgit}) (${e.codeUrl.split("/").at(-1)})`,value:e.id},null,8,["label","value"])))),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","loading"])):"envConfig"==e.type?(o(),d(k,{key:2,style:{width:"200px"},modelValue:U[e.key],"onUpdate:modelValue":l=>U[e.key]=l,disabled:e.disabled,filterable:"",clearable:"",placeholder:"请选择"},{default:i((()=>[(o(!0),m(p,null,y(n(f).envConfig.list,(e=>(o(),d(g,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):(o(),d(h,{key:3,style:{width:"200px"},modelValue:U[e.key],"onUpdate:modelValue":l=>U[e.key]=l,clearable:"",placeholder:"请输入"},null,8,["modelValue","onUpdate:modelValue"]))]})),_:2},1032,["label","prop"])))),128)),c(V,null,{default:i((()=>[c(w,{type:"primary",onClick:q},{default:i((()=>[u("搜索")])),_:1}),c(w,{onClick:l[0]||(l[0]=()=>{n(v).resetFields(),q()})},{default:i((()=>[u(" 重置 ")])),_:1})])),_:1})])),_:1},8,["model","disabled"])}}}),[["__scopeId","data-v-a3cdfddc"]]);export{I as C,B as P,me as _,L as a,A as b,ue as c,Q as d,Y as e,T as f,z as g,E as h,H as i,M as j,P as k,N as l,R as m};
