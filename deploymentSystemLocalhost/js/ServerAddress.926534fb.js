import{C as e,a,b as t,_ as s,c as i,d as o,e as l,f as n,g as r}from"./Search.a23fee55.js";import{E as d,a as m}from"./element-plus.96dd2a65.js";import{d as c,Z as p,o as b,c as f,U as g,u}from"./@vue.d99a4689.js";import"./vuex.1b7a4305.js";import"./vue-router.25eb8d08.js";import"./axios.b084b850.js";import"./index.779814a4.js";import"./lodash-es.d4f5f48c.js";import"./@vueuse.694ded36.js";import"./@element-plus.a15d8bac.js";import"./@popperjs.b78c3215.js";import"./@ctrl.91de2ec7.js";import"./dayjs.c6ebfc70.js";import"./async-validator.8d480e59.js";import"./memoize-one.63ab667a.js";import"./normalize-wheel-es.3222b0a2.js";import"./@floating-ui.3c499e77.js";import"./_plugin-vue_export-helper.1b428a4d.js";const y={class:"flex flex-column h-100p"},j=c({__name:"ServerAddress",setup(c){const j=p([{type:"input",label:"代码名称",key:"codeName",value:""},{type:"input",label:"代码地址",key:"codeUrl",value:""},{type:"input",label:"备注",key:"notes",value:""}]),k=p({page:1,size:10}),v=p([{label:"代码名称",key:"codeName",width:90},{type:"codeUrl",label:"代码地址",key:"codeUrl",width:150},{type:"select",label:"存放方式",key:"svnorgit",options:{svn:"svn",git:"git"},width:90},{label:"node版本",key:"nodeVersion",width:90},{label:"备注",key:"notes",width:120},{type:"datetime",label:"创建时间",key:"createdTime"},{type:"datetime",label:"修改时间",key:"modifyTime"}]),h=p({loading:!1,data:[],selectData:[],page:1,size:10,total:0}),D=p([{type:"success",label:"添加",key:"add"},{type:"primary",label:"编辑",key:"edit"},{type:"danger",label:"删除",key:"delete"},{type:"info",label:"详情",key:"details"}]),L=p({visible:!1,btnInfo:{},formList:[],formData:{loading:!1}}),w=p({formList:[{required:!0,type:"input",label:"代码地址",key:"codeUrl"},{required:!0,type:"input",label:"代码名称",maxlength:20,key:"codeName"},{required:!0,type:"select",label:"存放方式",key:"svnorgit",options:[{label:"svn",value:"svn"},{label:"git",value:"git"}]},{required:!0,type:"nodeVersion",label:"node版本",key:"nodeVersion"},{type:"textarea",label:"备注",maxlength:500,key:"notes"}],formData:{loading:!1,id:"",codeUrl:"",codeName:"",svnorgit:"",nodeVersion:"",notes:""}}),x=e=>{Object.assign(k,e),O()},O=(a=h.page,t=h.size)=>{h.loading=!0,e({...k,page:a,size:t}).then((e=>{Object.assign(h,e.data)})).catch((e=>{d.error(e.msg)})).finally((()=>{h.loading=!1}))},I=e=>{switch(L.formList.length=0,e.key){case"add":Object.assign(L.formList,w.formList),Object.assign(L.formData,w.formData),Object.assign(L.btnInfo,e),L.visible=!0;break;case"edit":case"details":Object.assign(L.formList,w.formList),Object.assign(L.formData,w.formData),Object.assign(L.btnInfo,e),z().then((()=>{L.visible=!0}));break;case"delete":_();break;default:d.info("暂未开启")}},z=()=>new Promise(((e,t)=>{if(1!=h.selectData.length)return d.warning("请选择一条数据"),t();L.formData.loading=!0,a({id:h.selectData[0].id}).then((a=>{Object.assign(L.formData,a.data),h.data.forEach((e=>{e.id==h.selectData[0].id&&Object.assign(e,a.data)})),e(L.formData)})).finally((()=>{L.formData.loading=!1,t()}))})),U=e=>{let a={add:n,edit:r};L.formData.loading=!0,a[e.btnInfo.key](e.formData).then((a=>{L.visible=!1,d.success(a.msg),["add"].includes(e.btnInfo.key)?O():z()})).finally((()=>{L.formData.loading=!1}))},_=()=>{if(!h.selectData.length)return d.warning("请至少选择一条数据");m.confirm("确定删除吗？","提示",{draggable:!0,beforeClose:(e,a,s)=>{if("confirm"===e)a.confirmButtonLoading=!0,t({ids:h.selectData.map((e=>e.id))}).then((e=>{s(),d.success(e.msg),O()})).finally((()=>{a.confirmButtonLoading=!1}));else s()}})};return(e,a)=>{const t=s,n=i,r=o,d=l;return b(),f("div",y,[g(t,{formList:u(j),tableData:u(h),onQuery:x},null,8,["formList","tableData"]),g(n,{class:"flex-1-1 overflow-auto",btnInfos:u(D),tableList:u(v),tableData:u(h),onClickBtn:I},null,8,["btnInfos","tableList","tableData"]),g(r,{btnInfos:u(D),pagination:u(h),onClickBtn:I,onPage:O,onSize:a[0]||(a[0]=e=>O(1,e))},null,8,["btnInfos","pagination"]),g(d,{dialogForm:u(L),onSubmitForm:U},null,8,["dialogForm"])])}}});export{j as default};
