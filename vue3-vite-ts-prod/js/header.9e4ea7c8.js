import{_ as e}from"./DialogForm.77d82fc6.js";import{a as s,y as a,A as r,B as i,h as o}from"./element-plus.d9718458.js";import"./vue.ea117135.js";import{q as l,r as t,a as n}from"./index.f86f8509.js";import{u as m}from"./vuex.16220312.js";import{u}from"./vue-router.b3f333f3.js";import{d as g,Z as d,o as p,c as f,R as c,a as b,u as y,M as j,O as v,U as w,T as k,S as h,F as x,az as D,aA as _}from"./@vue.eb62a264.js";import"./Form.c4ec9d19.js";import"./lodash-es.d4f5f48c.js";import"./@vueuse.45c6cd4e.js";import"./@element-plus.30484454.js";import"./@popperjs.b78c3215.js";import"./@ctrl.91de2ec7.js";import"./dayjs.11b573ac.js";import"./async-validator.7592c8ba.js";import"./memoize-one.63ab667a.js";import"./normalize-wheel-es.3222b0a2.js";import"./@floating-ui.36fbce82.js";import"./axios.5fdf0182.js";import"./universal-cookie.a55469f4.js";import"./mqtt.f77a2428.js";const C=e=>(D("data-v-3b4e133e"),e=e(),_(),e),P={class:"flex flex-align-center padding-t-b-15 padding-l-r-15 color-f page-bg"},q=C((()=>b("div",{class:"flex-1"},null,-1))),L={key:0,class:"iconfont icon-suoxiao"},N={key:1,class:"iconfont icon-fangda"},T={class:"el-dropdown-link color-f"},E=C((()=>b("i",{class:"iconfont icon-xiangxia font-12 margin-l-5"},null,-1))),F=C((()=>b("span",null,"信息修改",-1))),z=C((()=>b("span",null,"修改密码",-1))),S=C((()=>b("span",null,"退出登录",-1))),U=n(g({__name:"header",setup(n){const g=m(),D=u(),_=d({visible:!1,title:"标题",btnType:"",formList:[],formData:{loading:!1,userName:"",loginName:"",password:"",newPassword:"",surePassword:""}}),C=d({title:"信息修改",btnType:"myself",formList:[{type:"input",label:"用户名",key:"userName",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:2,max:20,message:"长度在2-20",trigger:["blur"]}]},{required:!0,type:"input",label:"登录名",key:"loginName",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:4,max:20,message:"长度在4-20",trigger:["blur"]}]}],formData:{loading:!1,userName:"",loginName:""}}),U=d({title:"修改密码",btnType:"password",formList:[{type:"password",label:"旧密码",key:"password",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:6,max:20,message:"长度在6-20",trigger:["blur"]}]},{type:"password",label:"新密码",key:"newPassword",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:6,max:20,message:"长度在6-20",trigger:["blur"]}]},{type:"password",label:"确认密码",key:"surePassword",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:6,max:20,message:"长度在6-20",trigger:["blur"]}]}],formData:{loading:!1,password:"",newPassword:"",surePassword:""}}),A=()=>{var e,a;switch(_.btnType){case"myself":_.formData.loading=!0,t(_.formData).then((async()=>{g.dispatch("RefreshTokenAndUserinfo").then((()=>{_.visible=!1}))})).finally((()=>{_.formData.loading=!1}));break;case"password":if((null==(e=_.formData)?void 0:e.newPassword)!=(null==(a=_.formData)?void 0:a.surePassword))return void s.error("两次密码不一致、请重新输入");_.formData.loading=!0,l(_.formData).then((()=>{_.visible=!1,D.push("/Login")})).finally((()=>{_.formData.loading=!1}))}};return(s,l)=>{const t=a,n=r,m=i,u=o,d=e;return p(),f(x,null,[c(" flex-pack-justify "),b("div",P,[b("div",{onClick:l[0]||(l[0]=e=>y(D).replace("/"))},"部署系统"),y(g).getters.authMenu.length?(p(),f("i",{key:0,class:"iconfont icon-menu margin-l-10",onClick:l[1]||(l[1]=e=>["xl","lg"].includes(y(g).getters.screenSize)?y(g).commit("SETCOLLAPSE",!y(g).getters.collapse):y(g).commit("SETDRAWERMENU",!y(g).getters.drawerMenu))})):c("v-if",!0),q,b("div",{class:"margin-r-10",onClick:l[2]||(l[2]=e=>y(g).dispatch("ChangeFullscreenElement"))},[y(g).getters.fullscreenElement?(p(),f("i",L)):(p(),f("i",N))]),y(g).getters.loginUserinfo?(p(),j(m,{key:1},{dropdown:v((()=>[w(n,null,{default:v((()=>[w(t,{onClick:l[3]||(l[3]=e=>(Object.assign(y(_),y(C)),Object.assign(y(_).formData,y(g).getters.loginUserinfo),y(_).visible=!0))},{default:v((()=>[F])),_:1}),w(t,{onClick:l[4]||(l[4]=e=>(Object.assign(y(_),y(U)),y(_).visible=!0))},{default:v((()=>[z])),_:1}),w(t,{onClick:l[5]||(l[5]=e=>y(D).push("/Login"))},{default:v((()=>[S])),_:1})])),_:1})])),default:v((()=>{var e;return[b("div",T,[b("span",null,k(null==(e=y(g).getters.loginUserinfo)?void 0:e.userName),1),E])]})),_:1})):(p(),j(u,{key:2,type:"primary",size:"mini",onClick:l[6]||(l[6]=e=>y(D).push("/Login"))},{default:v((()=>[h(" 登录 ")])),_:1}))]),w(d,{dialogForm:y(_),onSubmitForm:A},null,8,["dialogForm"])],64)}}}),[["__scopeId","data-v-3b4e133e"],["__file","D:/nodejs-egg-template-runningspace/default/666f9cfd3276ef2d39826b3c/src/layout/header.vue"]]);export{U as default};
