import{_ as e}from"./DialogForm.77d82fc6.js";import{e as a,f as l,g as s,h as o}from"./element-plus.d9718458.js";import"./vue.ea117135.js";import{C as r,b as t,U as i,c as n,d as m,a as d}from"./index.f86f8509.js";import{u}from"./vuex.16220312.js";import{u as g}from"./vue-router.b3f333f3.js";import{d as p,b as f,Z as c,j as b,c as v,a as j,U as y,O as k,u as w,a8 as D,F as _,az as x,aA as q,o as N,S as L}from"./@vue.eb62a264.js";import"./Form.c4ec9d19.js";import"./lodash-es.d4f5f48c.js";import"./@vueuse.45c6cd4e.js";import"./@element-plus.30484454.js";import"./@popperjs.b78c3215.js";import"./@ctrl.91de2ec7.js";import"./dayjs.11b573ac.js";import"./async-validator.7592c8ba.js";import"./memoize-one.63ab667a.js";import"./normalize-wheel-es.3222b0a2.js";import"./@floating-ui.36fbce82.js";import"./axios.5fdf0182.js";import"./universal-cookie.a55469f4.js";import"./mqtt.f77a2428.js";const h={class:"page-bg login flex flex-align-center flex-pack-center"},F={class:"login-info"},z=(e=>(x("data-v-206f2d94"),e=e(),q(),e))((()=>j("div",{class:"title font-b align-center"},"部署系统",-1))),V=d(p({__name:"Login",setup(d){const p=u(),x=g(),q=f(null);f(null);const V=c({btnLoading:!1,formList:[{required:!0,type:"input",label:"",key:"loginName"},{required:!0,type:"password",label:"",key:"password"}],formData:{loginName:"",password:""}}),U=c({visible:!1,title:"注册",formList:[{type:"input",label:"用户名",key:"userName",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:2,max:20,message:"长度在2-20",trigger:["blur"]}]},{type:"input",label:"登录名",key:"loginName",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:4,max:20,message:"长度在4-20",trigger:["blur"]}]},{type:"password",label:"密码",key:"password",rules:[{required:!0,message:"不能为空",trigger:["blur"]},{min:6,max:20,message:"长度在6-20",trigger:["blur"]}]}],formData:{loading:!1,userName:"",loginName:"",password:""}});b((()=>{r("token")&&(t("token"),window.location.reload()),p.commit("SETLOGINUSERINFO",null)}));const O=async()=>{var e;await(null==(e=q.value)?void 0:e.validate((e=>{e&&(V.btnLoading=!0,n(V.formData).then((async e=>{m("token",e.data.token),await p.dispatch("MqttEnd"),history.state.back?x.back():x.replace("/")})).finally((()=>{V.btnLoading=!1})))})))},S=async()=>{U.formData.loading=!0,i(U.formData).then((e=>{U.visible=!1,Object.assign(V.formData,U.formData),O()})).finally((()=>{U.formData.loading=!0}))};return(r,t)=>{const i=l,n=s,m=o,d=a,u=e;return N(),v(_,null,[j("div",h,[j("div",F,[z,y(d,{ref_key:"formRef",ref:q,model:w(V).formData,"status-icon":"",onKeyup:D(O,["enter"])},{default:k((()=>[y(n,{prop:"loginName",rules:[{required:!0,message:"不能为空",trigger:"blur"}]},{default:k((()=>[y(i,{modelValue:w(V).formData.loginName,"onUpdate:modelValue":t[0]||(t[0]=e=>w(V).formData.loginName=e),placeholder:"登录名",clearable:""},null,8,["modelValue"])])),_:1}),y(n,{prop:"password",rules:[{required:!0,message:"不能为空",trigger:"blur"}]},{default:k((()=>[y(i,{type:"password",modelValue:w(V).formData.password,"onUpdate:modelValue":t[1]||(t[1]=e=>w(V).formData.password=e),placeholder:"密码",clearable:""},null,8,["modelValue"])])),_:1}),y(n,null,{default:k((()=>{var e,a,l,s,o,r;return[y(m,{class:"flex-1",size:"large",loading:w(V).btnLoading||(null==(l=null==(a=null==(e=w(p))?void 0:e.getters)?void 0:a.loading)?void 0:l.request),onClick:t[2]||(t[2]=e=>w(U).visible=!0)},{default:k((()=>[L(" 注 册 ")])),_:1},8,["loading"]),y(m,{class:"flex-1",size:"large",loading:w(V).btnLoading||(null==(r=null==(o=null==(s=w(p))?void 0:s.getters)?void 0:o.loading)?void 0:r.request),type:"primary",onClick:O},{default:k((()=>[L(" 登 录 ")])),_:1},8,["loading"])]})),_:1})])),_:1},8,["model"])])]),y(u,{dialogForm:w(U),onSubmitForm:S},null,8,["dialogForm"])],64)}}}),[["__scopeId","data-v-206f2d94"],["__file","D:/nodejs-egg-template-runningspace/default/666f9cfd3276ef2d39826b3c/src/views/landingPage/Login.vue"]]);export{V as default};
