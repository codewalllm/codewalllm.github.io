import{k as e,j as a,a as t,l as o,m as r,h as l,v as n}from"./element-plus.d9718458.js";import{_ as s}from"./Form.c4ec9d19.js";import"./vue.ea117135.js";import{s as i,j as d,a as m}from"./index.f86f8509.js";import{u}from"./vuex.16220312.js";import{b as p}from"./vue-router.b3f333f3.js";import{d as f,b as c,Z as g,j as y,M as v,O as h,o as j,U as b,a as _,P as k,u as D,T as L,S as x}from"./@vue.eb62a264.js";import"./lodash-es.d4f5f48c.js";import"./@vueuse.45c6cd4e.js";import"./@element-plus.30484454.js";import"./@popperjs.b78c3215.js";import"./@ctrl.91de2ec7.js";import"./dayjs.11b573ac.js";import"./async-validator.7592c8ba.js";import"./memoize-one.63ab667a.js";import"./normalize-wheel-es.3222b0a2.js";import"./@floating-ui.36fbce82.js";import"./axios.5fdf0182.js";import"./universal-cookie.a55469f4.js";import"./mqtt.f77a2428.js";const C="http://123.60.131.126:7001";function I(e={}){return i({baseURL:C,url:"api/v1/menu/add",method:"post",data:e})}const O={class:"flex-1"},q=m(f({__name:"Menu",setup(m){const f=u();p();const q=c([]),U={1:"菜单",2:"页面",3:"按钮"},B=g({formList:[{type:"radio",label:"类型",key:"type",options:[{label:"菜单",value:"1"},{label:"页面",value:"2"},{label:"按钮",value:"3"}],rules:[{required:!0,message:"不能为空",trigger:["change"]}]},{type:"input",label:"页面",key:"name",placeholder:"路由中的name",rules:[{required:!0,message:"不能为空",trigger:["blur"]}]}],formData:{loading:!1,_id:"",type:"",path:"",name:"",component:""}}),M=g({formList:[{type:"input",label:"名称",key:"title",placeholder:"路由中的meta下的title",rules:[{required:!0,message:"不能为空",trigger:["blur"]}]},{type:"input",label:"图标",key:"icon",placeholder:"路由中的meta下的icon"},{type:"radio",label:"显隐",key:"hidden",placeholder:"路由中的meta下的hidden",options:[{label:"显示",value:!1},{label:"隐藏",value:!0}],rules:[{required:!0,message:"不能为空",trigger:["change"]}]}],formData:{loading:!1,title:"",icon:"",hidden:!1}});y((()=>{N()}));const N=()=>{d({menuTypes:["1","2","3"]}).then((e=>{q.value=e.data}))},R=async()=>{f.dispatch("GetAuthMenuTree","refresh"),N()},T=e=>{Object.assign(B.formData,e),Object.assign(M.formData,e.meta)},z=()=>{I(Object.assign({},B.formData,{meta:M.formData})).then((e=>{R()}))},w=()=>{I(Object.assign({},B.formData,{parentId:B.formData._id,meta:M.formData})).then((e=>{R()}))},A=()=>{(function(e={}){return i({baseURL:C,url:"api/v1/menu/edit",method:"put",data:e})})(Object.assign({},B.formData,{meta:M.formData})).then((e=>{R()}))},E=()=>{a.confirm("确定删除吗？","提示",{draggable:!0,beforeClose:(e,a,o)=>{if("confirm"===e)a.confirmButtonLoading=!0,(r={_id:B.formData._id},i({baseURL:C,url:`api/v1/menu/delete/${r._id}`,method:"delete"})).then((e=>{o(),t.success(e.message),R()})).finally((()=>{a.confirmButtonLoading=!1}));else o();var r}})},F=()=>{a.confirm("确定保存当前顺序吗？","提示",{draggable:!0,beforeClose:(e,a,o)=>{if("confirm"===e)a.confirmButtonLoading=!0,(r={menuOrder:q.value},i({baseURL:C,url:"api/v1/menu/saveOrder",method:"put",data:r})).then((e=>{o(),t.success(e.message),R()})).finally((()=>{a.confirmButtonLoading=!1}));else o();var r}})},G=(e,a,t,o)=>{console.log("draggingNode",e),console.log("dropNode",a),console.log("dropType",t),console.log("ev",o),"2"==e.data.type&&"1"==a.data.type||"3"==e.data.type&&"2"==a.data.type?e.data.parentId=a.data._id:e.data.parentId=a.data.parentId};return(a,t)=>{const i=o,d=r,m=s,u=l,p=e,c=n;return j(),v(p,{gutter:10},{default:h((()=>[b(d,{span:8},{default:h((()=>{var e,a,t,o,r,l;return[_("div",null,[k((j(),v(i,{"empty-text":D(q).length||(null==(t=null==(a=null==(e=D(f))?void 0:e.getters)?void 0:a.loading)?void 0:t.request)?"拼命加载中...":"暂无数据",data:D(q),"expand-on-click-node":!1,"default-expand-all":"","highlight-current":"",props:{label:"name",children:"children"},onNodeClick:T,draggable:"",onNodeDragEnd:G},{default:h((({data:e})=>{var a;return[_("span",O,L(null==(a=null==e?void 0:e.meta)?void 0:a.title)+"("+L(U[e.type])+")",1)]})),_:1},8,["empty-text","data"])),[[c,null==(l=null==(r=null==(o=D(f))?void 0:o.getters)?void 0:r.loading)?void 0:l.request]])])]})),_:1}),b(d,{span:16},{default:h((()=>[b(m,{formInfo:D(B)},null,8,["formInfo"]),b(m,{formInfo:D(M)},null,8,["formInfo"]),b(u,{type:"primary",onClick:R},{default:h((()=>[x("刷新")])),_:1}),b(u,{type:"primary",onClick:z},{default:h((()=>[x("一级菜单")])),_:1}),b(u,{type:"primary",onClick:w},{default:h((()=>[x("添加子集")])),_:1}),b(u,{type:"primary",onClick:A},{default:h((()=>[x("编辑")])),_:1}),b(u,{type:"primary",onClick:F},{default:h((()=>[x("保存顺序")])),_:1}),b(u,{type:"danger",onClick:E},{default:h((()=>[x("删除")])),_:1})])),_:1})])),_:1})}}}),[["__file","D:/nodejs-egg-template-runningspace/default/666f9cfd3276ef2d39826b3c/src/views/systemInfo/Menu.vue"]]);export{q as default};
