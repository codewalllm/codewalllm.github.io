import{_ as e}from"./DialogForm.77d82fc6.js";import{_ as a,a as t,b as s}from"./Search.4da002f7.js";import"./vue.ea117135.js";import{C as i,a as l,b as o,c as n,d as r}from"./codeinfoApi.54ff0829.js";import{a as d,j as m}from"./element-plus.d9718458.js";import{d as p,Z as c,j as b,c as u,U as g,u as f,o as y}from"./@vue.eb62a264.js";import{a as j}from"./index.f86f8509.js";import"./Form.c4ec9d19.js";import"./vuex.16220312.js";import"./vue-router.b3f333f3.js";import"./@element-plus.30484454.js";import"./lodash.a57d72c0.js";import"./dayjs.11b573ac.js";import"./lodash-es.d4f5f48c.js";import"./@vueuse.45c6cd4e.js";import"./@popperjs.b78c3215.js";import"./@ctrl.91de2ec7.js";import"./async-validator.7592c8ba.js";import"./memoize-one.63ab667a.js";import"./normalize-wheel-es.3222b0a2.js";import"./@floating-ui.36fbce82.js";import"./axios.5fdf0182.js";import"./universal-cookie.a55469f4.js";import"./mqtt.f77a2428.js";const k={class:"flex flex-column height-100p"},v=j(p({__name:"Codeinfo",setup(p){const j=c([{type:"input",label:"代码地址",key:"codeUrl",value:""},{type:"input",label:"备注",key:"remarks",value:""}]),v=c({page:1,size:10}),h=c([{label:"管理工具",key:"codeManagementTools",width:90},{type:"codeUrl",label:"代码地址",key:"codeUrl",width:100},{label:"备注",key:"remarks",width:90},{label:"node版本",key:"nodeVersion",width:90},{type:"datetime",label:"创建时间",key:"createdAt"},{type:"datetime",label:"修改时间",key:"updatedAt"}]),D=c({loading:!1,data:[],selectData:[],page:1,size:10,total:0}),w=c([{type:"success",label:"添加",key:"add"},{type:"primary",label:"编辑",key:"edit"},{type:"danger",label:"删除",key:"delete"}]),_=c({visible:!1,title:"用户信息",btnType:"",formList:[{type:"select",label:"管理工具",key:"codeManagementTools",options:[{label:"git",value:"git"},{label:"svn",value:"svn"}],rules:[{required:!0,message:"不能为空",trigger:["change"]}]},{type:"input",label:"代码地址",key:"codeUrl",rules:[{required:!0,message:"不能为空",trigger:["blur"]}]},{type:"input",label:"node版本",key:"nodeVersion",disabled:!0},{type:"textarea",label:"备注",key:"remarks"}],formData:{codeManagementTools:"",codeUrl:"",nodeVersion:"20.10.0",remarks:""}});b((()=>{z()}));const x=e=>{Object.assign(v,e),z(1)},z=(e=D.page,a=D.size)=>{D.loading=!0,i({...v,page:e,size:a}).then((e=>{Object.assign(D,e.data)})).finally((()=>{D.loading=!1}))},L=async(e,a={})=>{switch(_.title=null==e?void 0:e.label,_.btnType=null==e?void 0:e.key,e.key){case"add":_.visible=!0;break;case"edit":if(1!=D.selectData.length)return d.warning("请选择一条数据");_.visible=!0,Object.assign(_.formData,await C(D.selectData[0]));break;case"delete":U();break;default:d.info("暂未开启，敬请期待")}},T=async e=>{let a={add:n,edit:r};e.formData.loading=!0,a[e.btnType](e.formData).then((a=>{e.visible=!1,d.success(a.message),["add"].includes(e.btnType)?z(1):D.data.forEach((async a=>{e.formData._id==a._id&&Object.assign(a,await C(a))}))})).finally((()=>{e.formData.loading=!1}))},C=({_id:e})=>new Promise(((a,t)=>{l({_id:e}).then((e=>{a(e.data)}))})),U=()=>{if(0==D.selectData.length)return d.warning("请至少选择一条数据");m.confirm("确定删除吗？","提示",{draggable:!0,beforeClose:(e,a,t)=>{if("confirm"===e)a.confirmButtonLoading=!0,o({_ids:D.selectData.map((e=>e._id)).join(",")}).then((e=>{t(),d.success(e.message),z()})).finally((()=>{a.confirmButtonLoading=!1}));else t()}})};return(i,l)=>{const o=a,n=t,r=s,d=e;return y(),u("div",k,[g(o,{formList:f(j),tableData:f(D),onQuery:x},null,8,["formList","tableData"]),g(n,{class:"flex-1-1 overflow-auto",btnInfos:f(w),tableList:f(h),tableData:f(D),onClickBtn:L},null,8,["btnInfos","tableList","tableData"]),g(r,{btnInfos:f(w),pagination:f(D),onClickBtn:L,onPage:z,onSize:l[0]||(l[0]=e=>z(1,e))},null,8,["btnInfos","pagination"]),g(d,{dialogForm:f(_),onSubmitForm:T},null,8,["dialogForm"])])}}}),[["__file","D:/nodejs-egg-template-runningspace/default/666f9cfd3276ef2d39826b3c/src/views/pipelineManagement/Codeinfo.vue"]]);export{v as default};
